source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newsimutheory.pdf", height=3, width=3)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newsimutheory.pdf", height=3.5, width=3.5)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newmain.pdf", height=3.5, width=3.5)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
dev.off()
pdf("newmain.pdf", height=4.5, width=4.5)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
dev.off()
pdf("newsimutheory.pdf", height=4.5, width=4.5)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newsimutheory.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newmain.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
dev.off()
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
require(shades)
install.packages("shades")
require(shades)
?saturation
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.simu_and_theory()
pdf("newmain.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
dev.off()
pdf("newsimutheory.pdf", height=4.5, width=4.5)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newsimutheory.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
source("../newR/plotting.R"); plot_all_for_paper("tmp")
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
pdf("newsimutheory.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newmain.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
dev.off()
pdf("newmain.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
dev.off()
pdf("newsimutheory.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
?geom_text
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
?geom_text
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
pdf("newsimutheory.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
pdf("newsimutheory.pdf", height=4.0, width=4.0)
source("../newR/plotting.R"); ggplot.simu_and_theory()
dev.off()
q()
source("../newR/plotting.R"); ggplot.simu_and_theory()
?geom_text
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.simu_and_theory()
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=F)
?lightness
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); ggplot.main_result(results.main_analysis)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=F)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==30, ],                  aes(x=reorder(results.main_analysis[results.main_analysis$neighbourhood_size==30, ],           feature_ID, FUN=median), y=temperature, color=median(temperature))) + geom_boxplot() +         scale_y_log10()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==30, ], aes(x=reorder(results.main_analysis[results.main_analysis$neighbourhood_size==30, ], feature_ID, FUN=median, na.rm=TRUE), y=temperature, color=median(temperature))) + geom_boxplot() + scale_y_log10()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=reorder(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], feature_ID, FUN=median, na.rm=TRUE), y=temperature, color=median(temperature))) + geom_boxplot() + scale_y_log10()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=reorder(results.main_analysis[results.main_analysis$neighbourhood_size==10, ]$feature_ID, temperature, FUN=median, na.rm=TRUE), y=temperature, color=median(temperature))) + geom_boxplot() + scale_y_log10()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=reorder(results.main_analysis[results.main_analysis$neighbourhood_size==10, ]$feature_ID, temperature, FUN=median, na.rm=TRUE), y=temperature, color=median(temperature))) + geom_boxplot() + scale_y_log10() + coord_flip()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=reorder(results.main_analysis[results.main_analysis$neighbourhood_size==10, ]$feature_ID, temperature, FUN=median, na.rm=TRUE), y=temperature, color=feature_ID)) + geom_boxplot() + scale_y_log10() + coord_flip()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=reorder(results.main_analysis[results.main_analysis$neighbourhood_size==10, ]$feature_ID, temperature, FUN=median, na.rm=TRUE), y=temperature, color=feature_ID)) + geom_boxplot() + scale_y_log10() + coord_flip() + theme_bw() + theme(legend.position="none")
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
?geom_boxplot
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
warnings()
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
warnings()
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
rep(1:9, 21)*(10^rep(-10:10, each=9))
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
?annotation_logticks
?annotation_logticks
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
?annotation_logticks
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
?scale_y_log10()
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
1e+01
1e+01
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=F)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); ggplot.temperatures(results.main_analysis, descriptions=T)
source("../newR/plotting.R"); plot_all_for_paper(plot_interpolations=FALSE)
source("../newR/plotting.R"); plot_all_for_paper(plot_interpolations=FALSE, folder="../tmp")
merge_with_dediu(results.main_analysis, neighbourhood_size=10)
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4)
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pe")
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/stats.R")
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=F)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=F)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
q()
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); ggplot.dediu(results.main_analysis)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
q()
source("../newR/plotting.R"); plot_all_for_paper("../tmp", plot_interpolations=T)
correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=0, method="pearson")
correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pearson")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=0, method="pearson")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pearson")
correlate_OWNW(results.OWNW, method="spe")
correlate_OWNW(results.OWNW, method="pea")
correlate_OWNW(results.OWNW, method="spe")
correlate_over_neighbourhood_size(results.main_analysis, testee=10)
results.cpp_wals <- hipster::cat_csv.gz("../SCC/cpp_wals.tar.gz", csv_folder="results", pattern="^res.")
results.cpp_lattice <- hipster::cat_csv.gz("../SCC/cpp_lattice.tar.gz", csv_folder="results", pattern="^res.")
head(results.cpp_wals)
nrow(results.cpp_wals)
unique(results.cpp_wals$feature)
summary(results.cpp_wals)
head(results.cpp_wals)
ggplot(results.cpp_wals, aes(x=tau, y=tau_actual)) + geom_point()
ggplot(results.cpp_wals, aes(x=tau, y=tau_actual)) + geom_point() + scale_x_log10()
ggplot(results.cpp_wals, aes(x=tau, y=tau_actual)) + geom_point() + scale_x_log10() + scale_y_log10()
ggplot(results.cpp_wals, aes(x=tau, y=tau_actual)) + geom_point() + scale_x_log10() + scale_y_log10() + geom_smooth(method=lm)
9800/49
nrow(results.cpp_lattice)
cor.test(results.cpp_wals$tau, results.cpp_wals$tau_actual)
cor.test(results.cpp_wals$tau, results.cpp_wals$tau_actual, method="spe")
cor.test(log(results.cpp_wals$tau), log(results.cpp_wals$tau_actual), method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10)
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4)
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="spe")
cor.test(results.cpp_wals$tau, results.cpp_wals$tau_actual, method="spe")
cor.test(results.cpp_lattice$tau, results.cpp_lattice$tau_actual, method="spe")
head(results.cpp_wals)
head(aggregate(results.cpp_wals[, 12:13], list(results.cpp_wals$feature), median, na.rm=TRUE))
erkki <- aggregate(results.cpp_wals[, 12:13], list(results.cpp_wals$feature), median, na.rm=TRUE)
head(erkki)
nrow(erkki)
cor.test(erkki$tau, erkki$tau_actual, method="spe")
cor.test(log(results.cpp_wals$tau), log(results.cpp_wals$tau_actual), method="pe")
cor.test(log(results.cpp_lattice$tau), log(results.cpp_lattice$tau_actual), method="pe")
head(results.cpp_wals[!duplicate(results.cpp_wals), ])
head(results.cpp_wals[!duplicated(results.cpp_wals), ])
nrow(results.cpp_wals[!duplicated(results.cpp_wals), ])
nrow(results.cpp_wals)
source("../newR/stats.R"); correlate_cpp(cpp_wals)
source("../newR/stats.R"); correlate_cpp(results.cpp_wals)
source("../newR/stats.R"); correlate_cpp(results.cpp_lattice)
source("../newR/stats.R"); correlate_cpp(results.cpp_wals)
source("../newR/stats.R"); correlate_cpp(results.cpp_lattice)
source("../newR/stats.R"); correlate_OWNW(results.OWNW, method="pe")
source("../newR/stats.R"); correlate_OWNW(results.OWNW, method="spe")
source("../newR/stats.R"); correlate_OWNW(results.OWNW, method="pe")
source("../newR/stats.R"); correlate_over_neighbourhood_size(testee=10, results.main_analysis, method="pe")
source("../newR/plots.R"); plot_all_for_paper("../tmp")
source("../newR/plots.R"); plot_all_for_paper("../tmp")
source("../newR/plots.R"); plot_all_for_paper("../tmp")
q()
source("../newR/plots.R"); plot_all_for_paper("../tmp")
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
source("../newR/plotting.R"); plot_all_for_paper("../tmp", mapreso=0.5)
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
source("../newR/stats.R"); correlate_cpp(results.cpp_wals)
source("../newR/stats.R"); correlate_cpp(results.cpp_lattice)
source("../newR/stats.R"); correlate_cpp(results.cpp_lattice, method="pearson")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="spe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=5, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=6, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=7, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=30, no_of_knockouts=5, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=1, no_of_knockouts=5, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=4, no_of_knockouts=5, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=5, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=5, method="spe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=10, method="spe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=15, method="spe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=24, method="spe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="spe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="pe")
source("../newR/stats.R"); correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4, method="spe")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T)
require(ritwals)
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T)
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="family")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="family")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="family")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=1, verbose=T, unit="family")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=1, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="genus")
erkki
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=10, verbose=T, unit="genus")
erkki
hist(erkki$sigma)
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
hist(erkki$sigma)
source("../newR/sigmaunits.R"); erkki <- sigmaunits(k=1, cutoff=10, verbose=T, unit="family")
hist(erkki$sigma)
ggplot(erkki, aes(x=sigma)) + geom_density()
source("../newR/sigmaunits.R"); erkkig <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
ggplot(erkkig, aes(x=sigma)) + geom_density()
ggplot(erkki, aes(x=sigma)) + geom_density()
source("../newR/sigmaunits.R"); erkkig <- sigmaunits(k=1, cutoff=2, verbose=T, unit="genus")
ggplot(erkkig, aes(x=sigma)) + geom_density()
source("../newR/sigmaunits.R"); erkkig <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
ggplot(erkkig, aes(x=sigma)) + geom_density()
ggplot(erkkig, aes(x=sigma)) + geom_histogram()
ggplot(erkki, aes(x=sigma)) + geom_histogram()
ggplot(erkkig, aes(x=sigma)) + geom_density()
source("../newR/sigmaunits.R"); results.sigmabias_genera <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); results.sigmabias_families <- sigmaunits(k=1, cutoff=10, verbose=T, unit="family")
source("../newR/sigmaunits.R"); results.sigmabias_families <- sigmaunits(k=1, cutoff=10, verbose=T, unit="family")
head(results.sigmabias_families)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
source("../newR/sigmaunits.R"); results.sigmabias_genera <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
head(results.sigmabias_families)
head(results.sigmabias_genera)
source("../newR/sigmaunits.R"); results.sigmabias_genera <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); results.sigmabias_families <- sigmaunits(k=1, cutoff=10, verbose=T, unit="family")
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
source("../newR/sigmaunits.R"); results.sigmabias_families <- sigmaunits(k=1, cutoff=20, verbose=T, unit="family")
source("../newR/sigmaunits.R"); results.sigmabias_genera <- sigmaunits(k=1, cutoff=20, verbose=T, unit="genus")
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
source("../newR/sigmaunits.R"); results.sigmabias_families <- sigmaunits(k=1, cutoff=10, verbose=T, unit="family")
source("../newR/sigmaunits.R"); results.sigmabias_genera <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
head(results.sigmabias_families)
head(results.sigmabias_genera)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
source("../newR/sigmaunits.R"); results.sigmabias_genera <- sigmaunits(k=1, cutoff=10, verbose=T, unit="genus")
source("../newR/sigmaunits.R"); results.sigmabias_families <- sigmaunits(k=1, cutoff=10, verbose=T, unit="family")
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias_genera, results.sigmabias_families)
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
source("../newR/stats.R"); erkki <- correlate_over_neighbourhood_size(results.main_analysis, testee=10)
head(erkki)
source("../newR/plotting.R"); appendix.geoscale(erkki)
source("../newR/plotting.R"); appendix.geoscale(erkki)
source("../newR/plotting.R"); appendix.geoscale(erkki)
c(2, "2")
source("../newR/plotting.R"); plot_all_for_paper("../tmp", which="A3")
source("../newR/plotting.R"); plot_all_for_paper("../tmp", which=c("A2", "A3"))
ls()
head(walsdist)
walsdist <- read.csv("../newR/wals-distances-100closest-nosign.csv")
head(Walsdist)
head(walsdist)
ggplot(walsdist[walsdist$rank %in% c(1, 10, 50), ], aes(x=distance, fill=rank)) + geom_density(alpha=0.5)
ggplot(walsdist[walsdist$rank %in% c(1, 10, 50), ], aes(x=distance, fill=rank)) + geom_density(alpha=0.5)
ggplot(walsdist, aes(x=distance, fill=rank)) + geom_density(alpha=0.5)
ggplot(walsdist[walsdist$rank==10, ], aes(x=distance, fill=rank)) + geom_density(alpha=0.5)
ggplot(walsdist[walsdist$rank==50, ], aes(x=distance, fill=rank)) + geom_density(alpha=0.5)
ggplot(walsdist[walsdist$rank==100, ], aes(x=distance, fill=rank)) + geom_density(alpha=0.5)
ggplot(walsdist[walsdist$rank==10, ], aes(x=distance, fill=rank)) + geom_density(alpha=0.5)
ggplot(walsdist[walsdist$rank==10, ], aes(x=distance, fill=rank)) + geom_density()
ggplot(walsdist[walsdist$rank==10, ], aes(x=distance, fill=rank)) + geom_density() + theme_bw() + theme(legend.position="none")
ggplot(walsdist[walsdist$rank < 10, ], aes(x=distance, fill=rank)) + geom_density() + theme_bw() + theme(legend.position="none")
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance, fill=rank)) + geom_density() + theme_bw() + theme(legend.position="none")
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance)) + geom_density(fill="blue") + theme_bw() + theme(legend.position="none")
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance, fill=factor(rank))) + geom_density() + theme_bw() + theme(legend.position="none")
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance, fill=factor(rank))) + geom_density() + theme_bw() + theme(legend.position="none") + scale_x_log10()
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance, fill=factor(rank))) + geom_density() + theme_bw() + theme(legend.position="none")
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance)) + geom_density() + theme_bw() + theme(legend.position="none")
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance)) + geom_density() + theme_bw() + theme(legend.position="none") + facet_wrap(.~rank)
ggplot(walsdist[walsdist$rank <= 10, ], aes(x=distance)) + geom_density() + theme_bw() + theme(legend.position="none") + facet_wrap(.~rank, ncol=5)
source("../newR/plotting.R"); appendix.NN(walsdist)
source("../newR/plotting.R"); appendix.NN(walsdist)
source("../newR/plotting.R"); appendix.NN(walsdist)
source("../newR/plotting.R"); appendix.NN(walsdist)
source("../newR/plotting.R"); appendix.NN(walsdist)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", which=c("A1", "A2", "A3"))
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
q()
head(ritwals::WALS)
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); prep_data()
source("../newR/sigmabias_permutation.R"); erkki <- prep_data()
head(erkki)
df$value_ID
erkki$value_ID
head(erkki)
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=erkki)
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data())
?lapply
replicate(temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data()), n=2)
replicate(temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data()), n=2, simplify=FALSE)
do.call(rbind, replicate(temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data()), n=2, simplify=FALSE))
do.call(rbind, replicate(temperature(id="44A", up=1, down=6, NN_hash=read.csv("../newR/wals-distances-100closest-nosign.csv"), data=prep_data()), n=10, simplify=FALSE))
wals_distances <- read.csv("../newR/wals-distances-100closest-nosign.csv")
do.call(rbind, replicate(temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data()), n=10, simplify=FALSE))
erkki <- do.call(rbind, replicate(temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data()), n=100, simplify=FALSE))
head(erkki)
require(ggplot2)
ggplot(erkki, aes(x=temperature)) + geom_boxplot()
ggplot(erkki, aes(y=temperature)) + geom_boxplot()
ggplot(erkki, aes(y=temperature)) + geom_boxplot() + scale_y_log10()
source("../newR/sigmabias_permutation.R")
erkki <- do.call(rbind, lapply(X=1:10, temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X))))
erkki <- do.call(rbind, lapply(X=1:10, FUN=function(X) { temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X) })))
erkki <- do.call(rbind, lapply(X=1:10, FUN=function(X) { temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)) }))
erkki
prep_data()
prep_data()$family
length(unique(prep_data()$family))
erkki <- do.call(rbind, lapply(X=30:40, FUN=function(X) { df <- temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)); df$n <- X }))
erkki
erkki <- do.call(rbind, lapply(X=30:40, FUN=function(X) { df <- temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)); df$n <- X; df }))
erkki
erkki <- do.call(rbind, lapply(X=1:138, FUN=function(X) { df <- temperature(id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)); df$n <- X; df }))
erkki <- do.call(rbind, lapply(X=1:138, FUN=function(X) { df <- temperature(neighbourhood_size=10, id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)); df$n <- X; df }))
head(erkki)
ggplot(erkki, aes(x=n, y=temperature)) + geom_point()
ggplot(erkki, aes(x=n, y=temperature)) + geom_point() + scale_y_log10()
ggplot(erkki, aes(x=n, y=temperature)) + geom_point() + scale_y_log10() + geom_smooth(method=lm)
erkki <- do.call(rbind, replicate(do.call(rbind, lapply(X=1:13, FUN=function(X) { df <- temperature(neighbourhood_size=10, id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)); df$n <- X; df })), n=10, simplify=FALSE)
)
erkki <- do.call(rbind, replicate(do.call(rbind, lapply(X=1:13, FUN=function(X) { df <- temperature(neighbourhood_size=10, id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)); df$n <- X; df })), n=10, simplify=FALSE))
head(erkki)
nrow(erkki)
ggplot(erkki, aes(x=n, y=temperature)) + geom_point() + scale_y_log10() + geom_smooth(method=lm)
erkki <- do.call(rbind, lapply(X=1:138, FUN=function(X) { df <- temperature(neighbourhood_size=10, id="44A", up=1, down=6, NN_hash=wals_distances, data=prep_data(n=X)); df$n <- X; df }))
results.sigmabias <- hipster::cat_csv.gz("../SCC/sigmabias.tar.gz", csv_folder="results", pattern="^res.")
head(results.sigmabias)
head(aggregate(results.sigmabias[,c(2,10)], list(results.sigmabias$feature_ID), median))
head(aggregate(results.sigmabias[, 2], list(results.sigmabias$feature_ID, results.sigmabias$n), median))
head(aggregate(results.sigmabias[, 2], list(feature_ID=results.sigmabias$feature_ID, n=results.sigmabias$n), median))
aggregate(results.sigmabias[, 2], list(feature_ID=results.sigmabias$feature_ID, n=results.sigmabias$n), median)
aggregate(results.sigmabias[, 2], list(feature_ID=results.sigmabias$feature_ID, n=results.sigmabias$n), median, na.rm=TRUE)
head(aggregate(results.sigmabias[, 2], list(feature_ID=results.sigmabias$feature_ID, n=results.sigmabias$n), median))
head(results.sigmabias)
ggplot(results.sigmabias, aes(x=n, y=temperature)) + geom_point() + geom_smooth(model=lm)
ggplot(results.sigmabias, aes(x=n, y=temperature)) + geom_point() + geom_smooth(model=lm) + scale_y_log10()
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias)
head(results.sigmabias)
glm(temperature~n+rep, results.sigmabias)
?glm
glm(temperature~n+rep, data=results.sigmabias)
summary(glm(temperature~n+rep, data=results.sigmabias))
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", which="A3")
head(results.sigmabias)
ggplot(results.sigmabias, aes(x=n, y=temperature)) + geom_boxplot()
ggplot(results.sigmabias, aes(x=n, y=temperature)) + geom_boxplot() + scale_y_log10()
ggplot(results.sigmabias, aes(x=n, group=n, y=temperature)) + geom_boxplot() + scale_y_log10()
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias)
source("../newR/plotting.R"); appendix.sigmabias(results.sigmabias)
source("../newR/plotting.R"); plot_all_for_paper("../tmp", which="A3")
median(results.sigmabias$temperature, na.rm=TRUE)
head(results.main_analysis)
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=feature_frequency, color=feature_ID, y=temperature)) + geom_boxplot()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=feature_frequency, color=feature_ID, y=temperature)) + geom_boxplot() + scale_y_log10() + theme_bw()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=feature_frequency, color=feature_ID, y=temperature)) + geom_boxplot() + theme_bw()
ggplot(results.main_analysis[results.main_analysis$neighbourhood_size==10, ], aes(x=feature_frequency, color=feature_ID, y=temperature)) + geom_point() + scale_y_log10() + theme_bw()
source("../newR/stats.R")
correlate_OWNW(results.OWNW)
correlate_cpp(results.cpp_lattice)
correlate_cpp(results.cpp_wals)
correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=4)
correlate_with_dediu(results.main_analysis, neighbourhood_size=10, no_of_knockouts=0)
source("../newR/plotting.R"); plot_all_for_paper("../tmp")
source("../newR/plotting.R"); plot_all_for_paper("../tmp", which="A3")
q()
